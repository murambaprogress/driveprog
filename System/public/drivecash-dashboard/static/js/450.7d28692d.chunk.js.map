{"version":3,"file":"static/js/450.7d28692d.chunk.js","mappings":"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","sources":["services/adminApi.js","services/chatApi.js","layouts/admin/ChatAdmin.js"],"sourcesContent":["// Simple admin API wrapper with fetch and mock fallbacks\r\nconst API_BASE = process.env.REACT_APP_API_BASE || \"\";\r\n\r\nasync function safeFetch(path, opts = {}) {\r\n  const url = API_BASE + path;\r\n  try {\r\n    const res = await fetch(url, opts);\r\n    if (!res.ok) throw new Error(`API ${url} returned ${res.status}`);\r\n    return await res.json();\r\n  } catch (err) {\r\n    // Fallback: return null to let callers handle mock data\r\n    console.warn(\"adminApi safeFetch failed, falling back to mock:\", err.message);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function getUsers({ page = 1, pageSize = 10, query = \"\" } = {}) {\r\n  const qs = `?page=${page}&pageSize=${pageSize}&q=${encodeURIComponent(query)}`;\r\n  const r = await safeFetch(\"/api/admin/users\" + qs);\r\n  if (r) return r; // expected shape: { items: [], total }\r\n  // mock data (deterministic small generator)\r\n  const base = [\r\n    { id: \"user_001\", name: \"John Doe\", email: \"john.doe@email.com\", status: \"active\" },\r\n    { id: \"user_002\", name: \"Jane Smith\", email: \"jane.smith@email.com\", status: \"suspended\" },\r\n    { id: \"user_003\", name: \"Alice Park\", email: \"alice.park@email.com\", status: \"active\" },\r\n    { id: \"user_004\", name: \"Bob Lee\", email: \"bob.lee@email.com\", status: \"active\" },\r\n    { id: \"user_005\", name: \"Carla Gomez\", email: \"carla.gomez@email.com\", status: \"active\" },\r\n  ];\r\n\r\n  const all = Array.from({ length: 45 }).map((_, i) => base[i % base.length]).map((u, idx) => ({ ...u, id: `user_${100 + idx}`, name: `${u.name} ${idx}` }));\r\n  const q = (query || \"\").toLowerCase();\r\n  const filtered = q ? all.filter(u => (u.name || \"\").toLowerCase().includes(q) || (u.email || \"\").toLowerCase().includes(q) || (u.id || \"\").toLowerCase().includes(q)) : all;\r\n  const total = filtered.length;\r\n  const start = (page - 1) * pageSize;\r\n  const items = filtered.slice(start, start + pageSize);\r\n  return { items, total };\r\n}\r\n\r\nexport async function updateUser(id, patch) {\r\n  const r = await safeFetch(`/api/admin/users/${id}`, { method: \"PUT\", headers: { \"Content-Type\": \"application/json\" }, body: JSON.stringify(patch) });\r\n  if (r) return r;\r\n  // Mock: echo\r\n  return { id, ...patch };\r\n}\r\n\r\nexport async function getLoans(query = {}) {\r\n  const r = await safeFetch(`/api/admin/loans`);\r\n  if (r) return r;\r\n  return [];\r\n}\r\n\r\nexport async function approveLoan(id) {\r\n  const r = await safeFetch(`/api/admin/loans/${id}/approve`, { method: \"POST\" });\r\n  if (r) return r;\r\n  return { id, status: \"approved\" };\r\n}\r\n\r\nexport async function denyLoan(id, reason) {\r\n  const r = await safeFetch(`/api/admin/loans/${id}/deny`, { method: \"POST\", headers: { \"Content-Type\": \"application/json\" }, body: JSON.stringify({ reason }) });\r\n  if (r) return r;\r\n  return { id, status: \"denied\", reason };\r\n}\r\n\r\nexport async function refundPayment(paymentId, amount) {\r\n  const r = await safeFetch(`/api/admin/payments/${paymentId}/refund`, { method: \"POST\", headers: { \"Content-Type\": \"application/json\" }, body: JSON.stringify({ amount }) });\r\n  if (r) return r;\r\n  return { paymentId, refunded: true, amount };\r\n}\r\n\r\nexport async function getAnalytics() {\r\n  const r = await safeFetch(`/api/admin/analytics`);\r\n  if (r) return r;\r\n  // return mock KPIs\r\n  return {\r\n    totalUsers: 1240,\r\n    activeLoans: 320,\r\n    monthlyPayments: 45230,\r\n    revenue: 1234500,\r\n    paymentsByDay: Array.from({ length: 30 }, (_, i) => ({ date: `2025-08-${i + 1}`, amount: Math.floor(Math.random() * 5000) }))\r\n  };\r\n}\r\n\r\nexport async function getAuditLogs() {\r\n  const r = await safeFetch(`/api/admin/audit`);\r\n  if (r) return r;\r\n  return [\r\n    { id: \"log_001\", time: new Date().toISOString(), admin: \"admin_1\", action: \"approve_loan\", details: \"loan_101\" },\r\n    { id: \"log_002\", time: new Date().toISOString(), admin: \"admin_2\", action: \"refund_payment\", details: \"payment_202\" },\r\n  ];\r\n}\r\n\r\nexport async function logAdminAction(entry) {\r\n  const r = await safeFetch(`/api/admin/audit`, { method: \"POST\", headers: { \"Content-Type\": \"application/json\" }, body: JSON.stringify(entry) });\r\n  if (r) return r;\r\n  return { id: `log_${Date.now()}`, ...entry };\r\n}\r\n\r\nexport default {\r\n  getUsers,\r\n  updateUser,\r\n  getLoans,\r\n  approveLoan,\r\n  denyLoan,\r\n  refundPayment,\r\n  getAnalytics,\r\n  getAuditLogs,\r\n  logAdminAction,\r\n};\r\n","// Simple chat API with safeFetch and localStorage fallback to simulate 24/7 messaging\r\nimport adminApi from './adminApi';\r\n\r\nconst STORAGE_KEY = 'drivecash_mock_chats_v1';\r\n\r\nfunction readStore() {\r\n  try { return JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch (e) { return {}; }\r\n}\r\n\r\nfunction writeStore(store) { localStorage.setItem(STORAGE_KEY, JSON.stringify(store)); }\r\n\r\nasync function safeFetch(path, opts = {}) {\r\n  // try to leverage adminApi.safeFetch indirectly; adminApi exposes safeFetch internally but we reuse endpoints via fetch\r\n  try {\r\n    const res = await fetch(path, opts);\r\n    if (!res.ok) throw new Error('bad');\r\n    return await res.json();\r\n  } catch (err) {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function getConversations() {\r\n  const r = await safeFetch('/api/chat/conversations');\r\n  if (r) return r;\r\n  const store = readStore();\r\n  const convs = Object.values(store).map(c => ({ id: c.id, userId: c.userId, unread: c.messages.some(m=>m.direction==='user' && !m.readByAdmin), lastMessage: c.messages[c.messages.length-1] }));\r\n  return convs;\r\n}\r\n\r\nexport async function getMessages(conversationId) {\r\n  const r = await safeFetch(`/api/chat/${conversationId}/messages`);\r\n  if (r) return r;\r\n  const store = readStore();\r\n  return store[conversationId]?.messages || [];\r\n}\r\n\r\nexport async function startConversation(userId, meta={}) {\r\n  const r = await safeFetch(`/api/chat/start`, { method: 'POST', body: JSON.stringify({ userId, meta }) });\r\n  if (r) return r;\r\n  const store = readStore();\r\n  const id = `conv_${Date.now()}`;\r\n  store[id] = { id, userId, meta, messages: [] };\r\n  writeStore(store);\r\n  return store[id];\r\n}\r\n\r\nexport async function sendMessage(conversationId, { text, from = 'user' }) {\r\n  const r = await safeFetch(`/api/chat/${conversationId}/send`, { method: 'POST', body: JSON.stringify({ text, from }) });\r\n  if (r) return r;\r\n  const store = readStore();\r\n  const conv = store[conversationId] || { id: conversationId, userId: 'unknown', messages: [] };\r\n  const msg = { id: `m_${Date.now()}`, text, time: new Date().toISOString(), direction: from === 'user' ? 'user' : 'admin', readByAdmin: from === 'admin', readByUser: from === 'user' };\r\n  conv.messages.push(msg);\r\n  store[conversationId] = conv;\r\n  writeStore(store);\r\n  // log admin actions when admin sends\r\n  if (from === 'admin') await adminApi.logAdminAction({ time: new Date().toISOString(), admin: 'system', action: 'admin_message', details: `${conversationId}:${msg.id}` });\r\n  return msg;\r\n}\r\n\r\nexport async function markRead(conversationId, forWhom = 'admin') {\r\n  const r = await safeFetch(`/api/chat/${conversationId}/read`, { method: 'POST', body: JSON.stringify({ forWhom }) });\r\n  if (r) return r;\r\n  const store = readStore();\r\n  const conv = store[conversationId];\r\n  if (!conv) return null;\r\n  conv.messages = conv.messages.map(m => ({ ...m, ...(forWhom === 'admin' ? { readByAdmin: true } : { readByUser: true }) }));\r\n  store[conversationId] = conv;\r\n  writeStore(store);\r\n  return true;\r\n}\r\n\r\nexport async function markResolved(conversationId, resolvedBy = 'admin') {\r\n  // try server endpoint first\r\n  const r = await safeFetch(`/api/chat/${conversationId}/resolve`, { method: 'POST', body: JSON.stringify({ resolvedBy }) });\r\n  if (r) return r;\r\n\r\n  const store = readStore();\r\n  const conv = store[conversationId];\r\n  if (!conv) return null;\r\n  conv.resolved = true;\r\n  conv.resolvedAt = new Date().toISOString();\r\n  conv.resolvedBy = resolvedBy;\r\n  store[conversationId] = conv;\r\n  writeStore(store);\r\n\r\n  // increment admin resolved counter via adminApi if available\r\n  try { await (await import('./adminApi')).default.incrementResolvedCount && (await (await import('./adminApi')).default.incrementResolvedCount(resolvedBy)); } catch (e) { /* ignore */ }\r\n\r\n  return true;\r\n}\r\n\r\nexport default { getConversations, getMessages, startConversation, sendMessage, markRead };\r\n","/**\r\n * Admin Chat Inbox\r\n * Minimal admin UI to view conversations and reply to users.\r\n */\r\nimport React, { useEffect, useState, useRef } from 'react';\r\nimport Grid from '@mui/material/Grid';\r\nimport Card from '@mui/material/Card';\r\nimport List from '@mui/material/List';\r\nimport ListItem from '@mui/material/ListItem';\r\nimport ListItemText from '@mui/material/ListItemText';\r\nimport { VhoozhtTextarea } from 'components/VhoozhtForms';\r\nimport Button from '@mui/material/Button';\r\nimport Avatar from '@mui/material/Avatar';\r\nimport MDBox from 'components/MDBox';\r\nimport MDTypography from 'components/MDTypography';\r\nimport DashboardLayout from 'examples/LayoutContainers/DashboardLayout';\r\nimport DashboardNavbar from 'examples/Navbars/DashboardNavbar';\r\nimport Footer from 'examples/Footer';\r\n\r\nimport chatApi from '../../services/chatApi';\r\nimport socketService from '../../services/socket';\r\nimport adminDataService from '../../services/adminDataService';\r\n\r\nexport default function ChatAdmin() {\r\n\tconst [conversations, setConversations] = useState([]);\r\n\tconst [activeConv, setActiveConv] = useState(null);\r\n\tconst [messages, setMessages] = useState([]);\r\n\tconst [text, setText] = useState('');\r\n\tconst messagesEndRef = useRef(null);\r\n\r\n\tuseEffect(() => {\r\n\t\tlet mounted = true;\r\n\t\tasync function load() {\r\n\t\t\tconst convs = await chatApi.getConversations();\r\n\t\t\tif (mounted) setConversations(convs || []);\r\n\t\t}\r\n\t\tload();\r\n\r\n\t\t// subscribe to socket messages (noop fallback available)\r\n\t\tconst off = socketService.onSocketMessage((msg) => {\r\n\t\t\t// if message belongs to active conversation append\r\n\t\t\tif (msg && msg.conversationId && msg.message) {\r\n\t\t\t\tif (activeConv && msg.conversationId === activeConv.id) {\r\n\t\t\t\t\tsetMessages((m) => [...m, { id: `socket_${Date.now()}`, text: msg.message.text || msg.message, direction: 'user', time: new Date().toISOString() }]);\r\n\t\t\t\t}\r\n\t\t\t\t// reload conversations to update lastMessage/unread\r\n\t\t\t\tchatApi.getConversations().then(c => setConversations(c || []));\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn () => { mounted = false; off && off(); };\r\n\t}, [activeConv]);\r\n\r\n\tuseEffect(() => { scrollToBottom(); }, [messages]);\r\n\r\n\tasync function openConversation(conv) {\r\n\t\tsetActiveConv(conv);\r\n\t\tconst msgs = await chatApi.getMessages(conv.id);\r\n\t\tsetMessages(msgs || []);\r\n\t\t// mark read for admin\r\n\t\tchatApi.markRead(conv.id, 'admin').catch(() => {});\r\n\t}\r\n\r\n\tfunction scrollToBottom() {\r\n\t\ttry { messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' }); } catch (e) {}\r\n\t}\r\n\r\n\tasync function sendReply() {\r\n\t\tif (!activeConv || !text.trim()) return;\r\n\t\tconst msg = await chatApi.sendMessage(activeConv.id, { text: text.trim(), from: 'admin' });\r\n\t\tsetMessages((m) => [...m, { id: msg.id, text: msg.text || msg.message || text.trim(), direction: 'admin', time: msg.time || new Date().toISOString() }]);\r\n\t\tsetText('');\r\n\t\t// emit via socket\r\n\t\tsocketService.emitMessage(activeConv.id, { id: msg.id, text: msg.text || msg.message || text.trim(), from: 'admin' });\r\n\t\t// refresh conv list\r\n\t\tconst convs = await chatApi.getConversations();\r\n\t\tsetConversations(convs || []);\r\n\t}\r\n\r\n\tasync function resolveConversation() {\r\n\t\tif (!activeConv) return;\r\n\t\tawait chatApi.markResolved(activeConv.id, 'admin');\r\n\t\t// increment local admin resolved counter\r\n\t\ttry { adminDataService.incrementResolvedCount('admin_user', 1); } catch (e) {}\r\n\t\t// try to trigger server push notify for the conversation (if subscription present)\r\n\t\ttry {\r\n\t\t\tawait fetch('/api/push/send', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ conversationId: activeConv.id, payload: { title: 'Conversation resolved', body: `Your support conversation ${activeConv.id} was resolved by admin.` } }) });\r\n\t\t} catch (e) { console.warn('push/send failed', e); }\r\n\t\t// refresh conv list and clear active\r\n\t\tconst convs = await chatApi.getConversations();\r\n\t\tsetConversations(convs || []);\r\n\t\tsetActiveConv(null);\r\n\t\tsetMessages([]);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<DashboardLayout>\r\n\t\t\t<DashboardNavbar />\r\n\t\t\t<MDBox py={3}>\r\n\t\t\t\t<MDTypography variant=\"h4\" fontWeight=\"bold\" mb={1}>Admin Chat Inbox</MDTypography>\r\n\t\t\t\t<Grid container spacing={3}>\r\n\t\t\t\t\t<Grid item xs={12} md={4}>\r\n\t\t\t\t\t\t<Card sx={{ p: 2, height: '600px', overflowY: 'auto' }}>\r\n\t\t\t\t\t\t\t<MDTypography variant=\"h6\">Conversations</MDTypography>\r\n\t\t\t\t\t\t\t<List>\r\n\t\t\t\t\t\t\t\t{conversations.length === 0 && <ListItem><ListItemText primary=\"No conversations\" /></ListItem>}\r\n\t\t\t\t\t\t\t\t{conversations.map((c) => (\r\n\t\t\t\t\t\t\t\t\t<ListItem key={c.id} button selected={activeConv?.id === c.id} onClick={() => openConversation(c)}>\r\n\t\t\t\t\t\t\t\t\t\t<Avatar sx={{ mr: 2 }}>{String(c.userId || 'U').charAt(0)}</Avatar>\r\n\t\t\t\t\t\t\t\t\t\t<ListItemText primary={c.userId || c.id} secondary={c.lastMessage?.text || (c.lastMessage?.message && c.lastMessage.message) || 'â€”'} />\r\n\t\t\t\t\t\t\t\t\t</ListItem>\r\n\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t</List>\r\n\t\t\t\t\t\t</Card>\r\n\t\t\t\t\t</Grid>\r\n\r\n\t\t\t\t\t<Grid item xs={12} md={8}>\r\n\t\t\t\t\t\t<Card sx={{ p: 2, height: '600px', display: 'flex', flexDirection: 'column' }}>\r\n\t\t\t\t\t\t\t<MDTypography variant=\"h6\">{activeConv ? `Conversation: ${activeConv.id}` : 'Select a conversation'}</MDTypography>\r\n\t\t\t\t\t\t\t<MDBox sx={{ flex: 1, overflowY: 'auto', my: 2, p: 1, borderRadius: 1, backgroundColor: '#fafafa' }}>\r\n\t\t\t\t\t\t\t\t{messages.map((m) => (\r\n\t\t\t\t\t\t\t\t\t<MDBox key={m.id} display=\"flex\" justifyContent={m.direction === 'admin' ? 'flex-end' : 'flex-start'} mb={1}>\r\n\t\t\t\t\t\t\t\t\t\t<MDBox bgcolor={m.direction === 'admin' ? 'primary.main' : 'grey.200'} color={m.direction === 'admin' ? 'white' : 'text.primary'} px={2} py={1} borderRadius={2} maxWidth=\"70%\">\r\n\t\t\t\t\t\t\t\t\t\t\t<MDTypography variant=\"body2\">{m.text}</MDTypography>\r\n\t\t\t\t\t\t\t\t\t\t\t<MDTypography variant=\"caption\" display=\"block\" mt={0.5}>{new Date(m.time).toLocaleString()}</MDTypography>\r\n\t\t\t\t\t\t\t\t\t\t</MDBox>\r\n\t\t\t\t\t\t\t\t\t</MDBox>\r\n\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t<div ref={messagesEndRef} />\r\n\t\t\t\t\t\t\t</MDBox>\r\n\r\n\t\t\t\t\t\t\t<MDBox display=\"flex\" gap={1} alignItems=\"center\">\r\n\t\t\t\t\t\t\t\t<VhoozhtTextarea \r\n\t\t\t\t\t\t\t\t\tfullWidth \r\n\t\t\t\t\t\t\t\t\tmultiline \r\n\t\t\t\t\t\t\t\t\tmaxRows={4} \r\n\t\t\t\t\t\t\t\t\tminRows={1} \r\n\t\t\t\t\t\t\t\t\tplaceholder=\"Type a reply...\" \r\n\t\t\t\t\t\t\t\t\tvalue={text} \r\n\t\t\t\t\t\t\t\t\tonChange={(e) => setText(e.target.value)} \r\n\t\t\t\t\t\t\t\t\tonKeyDown={(e) => { if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); sendReply(); } }} \r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t<Button variant=\"contained\" color=\"primary\" onClick={sendReply}>Send</Button>\r\n\t\t\t\t\t\t\t\t<Button variant=\"outlined\" color=\"success\" onClick={resolveConversation} disabled={!activeConv}>Resolve</Button>\r\n\t\t\t\t\t\t\t</MDBox>\r\n\t\t\t\t\t\t</Card>\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t</Grid>\r\n\t\t\t</MDBox>\r\n\t\t\t<Footer />\r\n\t\t</DashboardLayout>\r\n\t);\r\n}\r\n"],"names":["API_BASE","process","REACT_APP_API_BASE","async","safeFetch","path","opts","arguments","length","undefined","url","res","fetch","ok","Error","concat","status","json","err","console","warn","message","getUsers","page","pageSize","query","qs","encodeURIComponent","r","base","id","name","email","all","Array","from","map","_","i","u","idx","_objectSpread","q","toLowerCase","filtered","filter","includes","total","start","items","slice","updateUser","patch","method","headers","body","JSON","stringify","getLoans","approveLoan","denyLoan","reason","refundPayment","paymentId","amount","refunded","getAnalytics","totalUsers","activeLoans","monthlyPayments","revenue","paymentsByDay","date","Math","floor","random","getAuditLogs","time","Date","toISOString","admin","action","details","logAdminAction","entry","now","STORAGE_KEY","readStore","parse","localStorage","getItem","e","writeStore","store","setItem","getConversations","Object","values","c","userId","unread","messages","some","m","direction","readByAdmin","lastMessage","getMessages","conversationId","_store$conversationId","startConversation","meta","sendMessage","_ref","text","conv","msg","readByUser","push","adminApi","markRead","forWhom","ChatAdmin","conversations","setConversations","useState","activeConv","setActiveConv","setMessages","setText","messagesEndRef","useRef","sendReply","trim","chatApi","socketService","convs","useEffect","mounted","load","off","then","_messagesEndRef$curre","current","scrollIntoView","behavior","scrollToBottom","_jsxs","DashboardLayout","children","_jsx","DashboardNavbar","MDBox","py","MDTypography","variant","fontWeight","mb","Grid","container","spacing","item","xs","md","Card","sx","p","height","overflowY","List","ListItem","ListItemText","primary","_c$lastMessage","_c$lastMessage2","button","selected","onClick","msgs","catch","openConversation","Avatar","mr","String","charAt","secondary","display","flexDirection","flex","my","borderRadius","backgroundColor","justifyContent","bgcolor","color","px","maxWidth","mt","toLocaleString","ref","gap","alignItems","VhoozhtTextarea","fullWidth","multiline","maxRows","minRows","placeholder","value","onChange","target","onKeyDown","key","shiftKey","preventDefault","Button","markResolved","adminDataService","incrementResolvedCount","payload","title","disabled","Footer"],"sourceRoot":""}