"use strict";(self.webpackChunkmaterial_dashboard_2_react=self.webpackChunkmaterial_dashboard_2_react||[]).push([[751,937],{937:(e,t,a)=>{a.r(t),a.d(t,{default:()=>D});var l=a(9379),n=a(5043),s=a(6460),i=a(8294),r=a(2110),o=a(1797),d=a(8961),c=(a(7125),a(6801)),u=a(1758),h=a(1751),p=a(8095),m=a(7311),x=a(35),g=a(6600),A=a(5316),v=a(9347),b=a(8903),j=a(3845),y=a(7392),f=a(4208),C=a(120),S=a(5397),k=a(7254),w=a(9135),L=a(4794),W=a(579);function R(e){let{open:t,onClose:a,loan:s,onSave:i}=e;const[r,o]=(0,n.useState)({amount:0,interestRate:0,term:0,status:"",remainingBalance:0,monthlyPayment:0});return(0,n.useEffect)(()=>{s&&o({amount:s.amount||0,interestRate:s.interestRate||0,term:s.term||0,status:s.status||"",remainingBalance:s.remainingBalance||0,monthlyPayment:s.monthlyPayment||0})},[s]),s?(0,W.jsxs)(x.A,{open:t,onClose:a,fullWidth:!0,maxWidth:"md",children:[(0,W.jsxs)(g.A,{children:["Edit Loan: ",s.id]}),(0,W.jsx)(A.A,{children:(0,W.jsxs)(b.Ay,{container:!0,spacing:2,sx:{mt:1},children:[(0,W.jsx)(b.Ay,{item:!0,xs:12,md:6,children:(0,W.jsx)(u.RL,{label:"Loan Amount ($)",fullWidth:!0,type:"number",value:r.amount,onChange:e=>o(t=>(0,l.A)((0,l.A)({},t),{},{amount:parseFloat(e.target.value)||0}))})}),(0,W.jsx)(b.Ay,{item:!0,xs:12,md:6,children:(0,W.jsx)(u.RL,{label:"Interest Rate (%)",fullWidth:!0,type:"number",step:"0.01",value:r.interestRate,onChange:e=>o(t=>(0,l.A)((0,l.A)({},t),{},{interestRate:parseFloat(e.target.value)||0}))})}),(0,W.jsx)(b.Ay,{item:!0,xs:12,md:4,children:(0,W.jsx)(u.RL,{label:"Term (months)",fullWidth:!0,type:"number",value:r.term,onChange:e=>o(t=>(0,l.A)((0,l.A)({},t),{},{term:parseInt(e.target.value)||0}))})}),(0,W.jsx)(b.Ay,{item:!0,xs:12,md:4,children:(0,W.jsx)(u.$3,{label:"Status",fullWidth:!0,value:r.status,onChange:e=>o(t=>(0,l.A)((0,l.A)({},t),{},{status:e.target.value})),options:[{value:"pending",label:"Pending"},{value:"approved",label:"Approved"},{value:"denied",label:"Denied"},{value:"active",label:"Active"},{value:"paid",label:"Paid"},{value:"defaulted",label:"Defaulted"}]})}),(0,W.jsx)(b.Ay,{item:!0,xs:12,md:4,children:(0,W.jsx)(u.RL,{label:"Monthly Extension ($)",fullWidth:!0,type:"number",value:r.monthlyPayment,onChange:e=>o(t=>(0,l.A)((0,l.A)({},t),{},{monthlyPayment:parseFloat(e.target.value)||0}))})}),(0,W.jsx)(b.Ay,{item:!0,xs:12,md:6,children:(0,W.jsx)(u.RL,{label:"Remaining Balance ($)",fullWidth:!0,type:"number",value:r.remainingBalance,onChange:e=>o(t=>(0,l.A)((0,l.A)({},t),{},{remainingBalance:parseFloat(e.target.value)||0}))})})]})}),(0,W.jsxs)(v.A,{children:[(0,W.jsx)(c.A,{variant:"outlined",onClick:a,children:"Cancel"}),(0,W.jsx)(c.A,{variant:"contained",onClick:()=>i((0,l.A)((0,l.A)({},s),r)),children:"Save Changes"})]})]}):null}function z(e){let{open:t,onClose:a,selectedLoans:l,onBulkAction:s}=e;const[i,r]=(0,n.useState)(""),[o,d]=(0,n.useState)(""),[h,p]=(0,n.useState)(0);return(0,W.jsxs)(x.A,{open:t,onClose:a,maxWidth:"sm",fullWidth:!0,children:[(0,W.jsxs)(g.A,{children:["Bulk Loan Operations (",l.length," loans selected)"]}),(0,W.jsx)(A.A,{children:(0,W.jsxs)(b.Ay,{container:!0,spacing:2,sx:{mt:1},children:[(0,W.jsx)(b.Ay,{item:!0,xs:12,children:(0,W.jsx)(u.$3,{label:"Operation",fullWidth:!0,value:i,onChange:e=>r(e.target.value),options:[{value:"approve",label:"Approve All"},{value:"deny",label:"Deny All"},{value:"updateStatus",label:"Update Status"},{value:"adjustRate",label:"Adjust Interest Rate"},{value:"delete",label:"Delete All"}]})}),"updateStatus"===i&&(0,W.jsx)(b.Ay,{item:!0,xs:12,children:(0,W.jsx)(u.$3,{label:"New Status",fullWidth:!0,value:o,onChange:e=>d(e.target.value),options:[{value:"pending",label:"Pending"},{value:"approved",label:"Approved"},{value:"denied",label:"Denied"},{value:"active",label:"Active"},{value:"paid",label:"Paid"},{value:"defaulted",label:"Defaulted"}]})}),"adjustRate"===i&&(0,W.jsx)(b.Ay,{item:!0,xs:12,children:(0,W.jsx)(u.RL,{fullWidth:!0,label:"Interest Rate Adjustment (%)",type:"number",step:"0.01",value:h,onChange:e=>p(parseFloat(e.target.value)||0),helperText:"Positive number to increase, negative to decrease"})})]})}),(0,W.jsxs)(v.A,{children:[(0,W.jsx)(c.A,{variant:"outlined",onClick:a,children:"Cancel"}),(0,W.jsx)(c.A,{variant:"contained",onClick:()=>{const e=l.map(e=>e.id);switch(i){case"approve":s("approve",e);break;case"deny":s("deny",e);break;case"updateStatus":o&&s("status",e,{status:o});break;case"adjustRate":0!==h&&s("rate",e,{rateAdjustment:h});break;case"delete":window.confirm("Are you sure you want to delete ".concat(e.length," loans? This action cannot be undone."))&&s("delete",e)}a()},children:"Apply"})]})]})}const D=function(){const[e,t]=(0,n.useState)([]),[a,x]=(0,n.useState)(0),[g,A]=(0,n.useState)(!1),[v,D]=(0,n.useState)(""),[I,P]=(0,n.useState)(""),[B,E]=(0,n.useState)(""),[F,T]=(0,n.useState)(""),[$,M]=(0,n.useState)(""),[_,H]=(0,n.useState)(""),[O,N]=(0,n.useState)(1),[J,U]=(0,n.useState)(10),[V,X]=(0,n.useState)("applicationDate"),[q,G]=(0,n.useState)("desc"),[K,Q]=(0,n.useState)([]),[Y,Z]=(0,n.useState)(!1),[ee,te]=(0,n.useState)(null),[ae,le]=(0,n.useState)(!1),[ne,se]=(0,n.useState)(!1),[ie,re]=(0,n.useState)({open:!1,message:"",severity:"success"}),oe=function(e){re({open:!0,message:e,severity:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success"})},de=(0,n.useCallback)(async()=>{A(!0);try{const e={page:O,pageSize:J,search:v,status:I,dateFrom:B,dateTo:F,amountMin:$?parseFloat($):void 0,amountMax:_?parseFloat(_):void 0,sortBy:V,sortOrder:q},a=m.A.getLoans(e);t(a.items),x(a.total)}catch(e){oe("Error loading loans","error")}finally{A(!1)}},[O,J,v,I,B,F,$,_,V,q]);(0,n.useEffect)(()=>{de()},[de]);const ce=Math.max(1,Math.ceil(a/J)),ue=e=>{switch(e){case"approved":case"paid":return"success";case"denied":case"defaulted":return"error";case"pending":return"warning";case"active":return"info";default:return"default"}};return(0,W.jsxs)(s.A,{children:[(0,W.jsx)(i.A,{}),(0,W.jsxs)(r.A,{children:[(0,W.jsxs)(o.A,{p:3,children:[(0,W.jsxs)(o.A,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[(0,W.jsxs)(o.A,{children:[(0,W.jsx)(d.A,{variant:"h6",children:"Loans Management"}),(0,W.jsxs)(d.A,{variant:"caption",color:"text",children:["Total: ",a," loans | Selected: ",K.length]})]}),(0,W.jsxs)(o.A,{display:"flex",gap:1,children:[(0,W.jsx)(c.A,{variant:"outlined",onClick:()=>{const t=K.length?K:e;m.A.exportCSV("loans",t),oe("Exported ".concat(t.length," loans to CSV"))},disabled:!e.length,children:"Export CSV"}),(0,W.jsx)(c.A,{variant:"outlined",onClick:()=>{m.A.exportData("loans"),oe("Loans data exported to JSON")},children:"Export JSON"}),K.length>0&&(0,W.jsxs)(c.A,{variant:"contained",color:"warning",onClick:()=>se(!0),children:["Bulk Actions (",K.length,")"]})]})]}),(0,W.jsxs)(b.Ay,{container:!0,spacing:2,mb:2,children:[(0,W.jsx)(b.Ay,{item:!0,xs:12,md:3,children:(0,W.jsx)(u.RL,{placeholder:"Search loans...",value:v,onChange:e=>{D(e.target.value),N(1)},fullWidth:!0})}),(0,W.jsx)(b.Ay,{item:!0,xs:12,md:2,children:(0,W.jsx)(u.$3,{label:"Status",size:"small",fullWidth:!0,value:I,onChange:e=>{P(e.target.value),N(1)},options:[{value:"",label:"All"},{value:"pending",label:"Pending"},{value:"approved",label:"Approved"},{value:"denied",label:"Denied"},{value:"active",label:"Active"},{value:"paid",label:"Paid"},{value:"defaulted",label:"Defaulted"}]})}),(0,W.jsx)(b.Ay,{item:!0,xs:12,md:2,children:(0,W.jsx)(u.RL,{label:"Date From",type:"date",fullWidth:!0,size:"small",value:B,onChange:e=>{E(e.target.value),N(1)},InputLabelProps:{shrink:!0}})}),(0,W.jsx)(b.Ay,{item:!0,xs:12,md:2,children:(0,W.jsx)(u.RL,{label:"Date To",type:"date",fullWidth:!0,size:"small",value:F,onChange:e=>{T(e.target.value),N(1)},InputLabelProps:{shrink:!0}})}),(0,W.jsx)(b.Ay,{item:!0,xs:12,md:1.5,children:(0,W.jsx)(u.RL,{label:"Min Amount",type:"number",fullWidth:!0,size:"small",value:$,onChange:e=>{M(e.target.value),N(1)}})}),(0,W.jsx)(b.Ay,{item:!0,xs:12,md:1.5,children:(0,W.jsx)(u.RL,{label:"Max Amount",type:"number",fullWidth:!0,size:"small",value:_,onChange:e=>{H(e.target.value),N(1)}})})]}),(0,W.jsxs)(o.A,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,W.jsx)(c.A,{variant:"outlined",onClick:()=>{D(""),P(""),E(""),T(""),M(""),H(""),N(1)},size:"small",children:"Clear Filters"}),(0,W.jsxs)(o.A,{display:"flex",alignItems:"center",gap:1,children:[(0,W.jsx)(d.A,{variant:"caption",children:"Sort by:"}),(0,W.jsx)(u.$3,{size:"small",value:V,onChange:e=>X(e.target.value),options:[{value:"applicationDate",label:"Application Date"},{value:"amount",label:"Amount"},{value:"interestRate",label:"Interest Rate"},{value:"term",label:"Term"},{value:"status",label:"Status"}]}),(0,W.jsx)(u.$3,{size:"small",value:q,onChange:e=>G(e.target.value),options:[{value:"asc",label:"Ascending"},{value:"desc",label:"Descending"}]})]})]})]}),(0,W.jsx)(h.A,{columns:[{id:"id",label:"Loan ID",width:120,minWidth:100,align:"left",format:e=>(0,W.jsx)(d.A,{variant:"button",fontWeight:"medium",noWrap:!0,children:e})},{id:"borrowerName",label:"Borrower",width:200,minWidth:150,align:"left",format:e=>(0,W.jsx)(d.A,{variant:"body2",noWrap:!0,title:e,children:e})},{id:"amount",label:"Amount",width:140,align:"right",format:e=>p._J.currency(e)},{id:"interestRate",label:"Rate",width:100,align:"center",format:e=>p._J.percentage(e)},{id:"term",label:"Term",width:120,align:"center",format:e=>"".concat(e," months")},{id:"status",label:"Status",width:120,align:"center",format:e=>(0,W.jsx)(j.A,{label:e,color:ue(e),size:"small"})},{id:"applicationDate",label:"Applied",width:130,align:"center",format:e=>p._J.date(e)},{id:"actions",label:"Actions",width:150,align:"center",format:(e,t)=>(0,W.jsxs)(o.A,{display:"flex",justifyContent:"center",gap:1,children:[(0,W.jsx)(C.A,{title:"Edit Loan",children:(0,W.jsx)(y.A,{size:"small",onClick:()=>{te(t),le(!0)},sx:{width:32,height:32,"&:hover":{bgcolor:(0,L.X4)("#2196f3",.1)}},children:(0,W.jsx)(f.A,{fontSize:"small",children:"edit"})})}),"pending"===t.status&&(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(C.A,{title:"Approve Loan",children:(0,W.jsx)(y.A,{size:"small",onClick:()=>(async e=>{try{m.A.approveLoans([e]).approvedCount>0&&(oe("Loan approved successfully"),de())}catch(t){oe("Error approving loan","error")}})(t.id),sx:{width:32,height:32,color:"#4caf50","&:hover":{bgcolor:(0,L.X4)("#4caf50",.1)}},children:(0,W.jsx)(f.A,{fontSize:"small",children:"check"})})}),(0,W.jsx)(C.A,{title:"Deny Loan",children:(0,W.jsx)(y.A,{size:"small",onClick:()=>(async e=>{try{m.A.denyLoans([e]).deniedCount>0&&(oe("Loan denied"),de())}catch(t){oe("Error denying loan","error")}})(t.id),sx:{width:32,height:32,color:"#f44336","&:hover":{bgcolor:(0,L.X4)("#f44336",.1)}},children:(0,W.jsx)(f.A,{fontSize:"small",children:"close"})})})]})]})}],data:e,selectedItems:K,onSelectAll:t=>{Z(t),Q(t?[...e]:[])},onSelectItem:(e,t)=>{t?Q([...K,e]):(Q(K.filter(t=>t.id!==e.id)),Z(!1))},showCheckbox:!0,stickyHeader:!1,maxHeight:"70vh"}),(0,W.jsxs)(o.A,{p:3,display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,W.jsxs)(o.A,{display:"flex",alignItems:"center",gap:2,children:[(0,W.jsx)(d.A,{variant:"caption",children:"Page size:"}),(0,W.jsx)(u.$3,{size:"small",value:J,onChange:e=>{U(Number(e.target.value)),N(1)},options:[{value:5,label:"5"},{value:10,label:"10"},{value:25,label:"25"},{value:50,label:"50"}]})]}),(0,W.jsx)(w.A,{count:ce,page:O,onChange:(e,t)=>N(t),color:"primary"})]}),(0,W.jsx)(R,{open:ae,onClose:()=>le(!1),loan:ee,onSave:async e=>{try{m.A.updateLoan(e.id,e)&&(oe("Loan updated successfully"),le(!1),de())}catch(t){oe("Error updating loan","error")}}}),(0,W.jsx)(z,{open:ne,onClose:()=>se(!1),selectedLoans:K,onBulkAction:async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{let l;switch(e){case"approve":l=m.A.approveLoans(t),oe("".concat(l.approvedCount," loans approved"));break;case"deny":l=m.A.denyLoans(t),oe("".concat(l.deniedCount," loans denied"));break;case"status":l=m.A.bulkUpdateLoans(t,{status:a.status}),oe("".concat(l.updatedCount," loans updated"));break;case"rate":l=m.A.bulkUpdateLoans(t,a),oe("".concat(l.updatedCount," loans updated"));break;case"delete":l=m.A.bulkDeleteLoans(t),oe("".concat(l.deletedCount," loans deleted"))}Q([]),Z(!1),de()}catch(l){oe("Error performing bulk operation","error")}}}),(0,W.jsx)(S.A,{open:ie.open,autoHideDuration:4e3,onClose:()=>re((0,l.A)((0,l.A)({},ie),{},{open:!1})),children:(0,W.jsx)(k.A,{severity:ie.severity,onClose:()=>re((0,l.A)((0,l.A)({},ie),{},{open:!1})),children:ie.message})})]})]})}},1751:(e,t,a)=>{a.d(t,{A:()=>y});a(5043);var l=a(9650),n=a(4882),s=a(39),i=a(8076),r=a(3336),o=a(1806),d=a(1962),c=a(3460),u=a(5658),h=a(1797),p=a(8961),m=a(579);const x=(0,u.Ay)(l.A)(e=>{let{theme:t}=e;return{borderRadius:t.spacing(2),overflow:"hidden",boxShadow:"none",border:"1px solid ".concat(t.palette.grey[200])}}),g=(0,u.Ay)(n.A)(e=>{let{theme:t}=e;return{backgroundColor:t.palette.grey[50]}}),A=(0,u.Ay)(s.A)(e=>{let{theme:t,width:a}=e;return{padding:t.spacing(2),fontSize:"0.875rem",fontWeight:500,borderBottom:"1px solid ".concat(t.palette.grey[200]),whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",width:a||"auto",maxWidth:a?"".concat(a,"px"):"none","&.MuiTableCell-head":{backgroundColor:t.palette.grey[50],fontWeight:600,color:t.palette.text.primary,textTransform:"uppercase",fontSize:"0.75rem",letterSpacing:"0.5px"}}}),v=(0,u.Ay)(i.A)(e=>{let{theme:t}=e;return{"&:hover":{backgroundColor:t.palette.action.hover},"&:last-child td":{borderBottom:0}}}),b=(0,u.Ay)(h.A)({display:"flex",alignItems:"center",maxWidth:"100%",overflow:"hidden"}),j=(0,u.Ay)(p.A)(e=>{let{maxWidth:t=200}=e;return{maxWidth:"".concat(t,"px"),overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}});const y=function(e){let{columns:t=[],data:a=[],selectedItems:l=[],onSelectAll:n,onSelectItem:s,showCheckbox:u=!1,stickyHeader:y=!1,maxHeight:f="auto",responsive:C=!0}=e;const S=a.length>0&&l.length===a.length,k=l.length>0&&l.length<a.length;return(0,m.jsx)(x,{component:r.A,sx:{maxHeight:f,overflow:"auto"},children:(0,m.jsxs)(o.A,{stickyHeader:y,size:"medium",children:[(0,m.jsx)(g,{children:(0,m.jsxs)(i.A,{children:[u&&(0,m.jsx)(A,{padding:"checkbox",width:50,children:(0,m.jsx)(d.A,{indeterminate:k,checked:S,onChange:e=>{n&&n(e.target.checked)},color:"primary"})}),t.map(e=>(0,m.jsx)(A,{align:e.align||"left",width:e.width,sx:{minWidth:e.minWidth||"auto"},children:e.label},e.id))]})}),(0,m.jsxs)(c.A,{children:[a.map((e,a)=>{return(0,m.jsxs)(v,{children:[u&&(0,m.jsx)(A,{padding:"checkbox",children:(0,m.jsx)(d.A,{checked:l.some(t=>t.id===e.id),onChange:(n=e,e=>{s&&s(n,e.target.checked)}),color:"primary"})}),t.map(t=>(0,m.jsx)(A,{align:t.align||"left",width:t.width,children:(0,m.jsx)(b,{children:t.format?t.format(e[t.id],e):(0,m.jsx)(j,{variant:"body2",maxWidth:t.maxWidth||200,title:String(e[t.id]),children:e[t.id]})})},t.id))]},e.id||a);var n}),0===a.length&&(0,m.jsx)(v,{children:(0,m.jsx)(A,{colSpan:t.length+(u?1:0),align:"center",children:(0,m.jsx)(h.A,{py:4,children:(0,m.jsx)(p.A,{variant:"body2",color:"text",opacity:.7,children:"No data available"})})})})]})]})})}}}]);
//# sourceMappingURL=937.d4deaa28.chunk.js.map