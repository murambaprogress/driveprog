"use strict";(self.webpackChunkmaterial_dashboard_2_react=self.webpackChunkmaterial_dashboard_2_react||[]).push([[207],{7207:(e,t,n)=>{n.r(t),n.d(t,{default:()=>D});var a=n(9379),l=n(5043),s=n(6460),i=n(8294),r=n(2110),o=n(1797),c=n(8961),d=n(6801),m=n(8944),u=n(1751),p=n(8903),x=n(4535),h=n(8095),y=n(579);(0,x.Ay)(r.A)(e=>{let{theme:t,elevation:n=1}=e;return{borderRadius:t.spacing(2),padding:t.spacing(3),boxShadow:"none"===n?"none":t.shadows[n],border:"1px solid ".concat(t.palette.grey[200]),height:"100%",display:"flex",flexDirection:"column",transition:"box-shadow 0.3s ease-in-out","&:hover":{boxShadow:"none"!==n?t.shadows[Math.min(n+2,24)]:"none"},[t.breakpoints.down("md")]:{padding:t.spacing(2)},[t.breakpoints.down("sm")]:{padding:t.spacing(1.5)}}}),(0,x.Ay)(p.Ay)(e=>{let{theme:t}=e;return{gap:t.spacing(3),[t.breakpoints.down("md")]:{gap:t.spacing(2)},[t.breakpoints.down("sm")]:{gap:t.spacing(1.5)}}}),(0,x.Ay)(o.A)(e=>{let{theme:t}=e;return{display:"flex",alignItems:"center",justifyContent:"space-between",padding:t.spacing(1.5,0),borderBottom:"1px solid ".concat(t.palette.grey[100]),"&:last-child":{borderBottom:"none"},[t.breakpoints.down("sm")]:{flexDirection:"column",alignItems:"flex-start",gap:t.spacing(.5)}}}),(0,x.Ay)(o.A)(e=>{let{theme:t}=e;return{display:"flex",gap:t.spacing(1.5),marginTop:"auto",paddingTop:t.spacing(2),borderTop:"1px solid ".concat(t.palette.grey[100]),[t.breakpoints.down("sm")]:{flexDirection:"column",gap:t.spacing(1)},"& .MuiButton-root, & .MDButton-root":{flex:1,minHeight:"40px",[t.breakpoints.down("sm")]:{width:"100%"}}}});var g=n(7311),A=(n(3581),n(35)),j=n(6600),f=n(5316),b=n(9347),v=n(3845),w=n(7392),C=n(4208),S=n(5397),k=n(7254),I=n(9135),P=n(7601);function z(e){let{open:t,onClose:n,payment:a,onRefund:l,onCancel:s}=e;return a?(0,y.jsxs)(A.A,{open:t,onClose:n,fullWidth:!0,maxWidth:"sm",children:[(0,y.jsx)(j.A,{children:"Payment Details"}),(0,y.jsx)(f.A,{children:(0,y.jsxs)(p.Ay,{container:!0,spacing:2,sx:{mt:1},children:[(0,y.jsxs)(p.Ay,{item:!0,xs:12,md:6,children:[(0,y.jsx)(c.A,{variant:"caption",color:"text",children:"Payment ID"}),(0,y.jsx)(c.A,{variant:"body2",children:a.id})]}),(0,y.jsxs)(p.Ay,{item:!0,xs:12,md:6,children:[(0,y.jsx)(c.A,{variant:"caption",color:"text",children:"Loan ID"}),(0,y.jsx)(c.A,{variant:"body2",children:a.loanId})]}),(0,y.jsxs)(p.Ay,{item:!0,xs:12,md:6,children:[(0,y.jsx)(c.A,{variant:"caption",color:"text",children:"Borrower"}),(0,y.jsx)(c.A,{variant:"body2",children:a.borrowerName})]}),(0,y.jsxs)(p.Ay,{item:!0,xs:12,md:6,children:[(0,y.jsx)(c.A,{variant:"caption",color:"text",children:"Amount"}),(0,y.jsxs)(c.A,{variant:"h6",children:["$",a.amount.toLocaleString()]})]}),(0,y.jsxs)(p.Ay,{item:!0,xs:12,md:6,children:[(0,y.jsx)(c.A,{variant:"caption",color:"text",children:"Payment Date"}),(0,y.jsx)(c.A,{variant:"body2",children:h._J.date(a.paymentDate)})]}),(0,y.jsxs)(p.Ay,{item:!0,xs:12,md:6,children:[(0,y.jsx)(c.A,{variant:"caption",color:"text",children:"Status"}),(0,y.jsx)(v.A,{label:a.status,color:"completed"===a.status?"success":"failed"===a.status?"error":"warning",size:"small"})]}),(0,y.jsxs)(p.Ay,{item:!0,xs:12,md:6,children:[(0,y.jsx)(c.A,{variant:"caption",color:"text",children:"Type"}),(0,y.jsx)(c.A,{variant:"body2",children:a.type})]}),(0,y.jsxs)(p.Ay,{item:!0,xs:12,md:6,children:[(0,y.jsx)(c.A,{variant:"caption",color:"text",children:"Method"}),(0,y.jsx)(c.A,{variant:"body2",children:a.method})]}),a.description&&(0,y.jsxs)(p.Ay,{item:!0,xs:12,children:[(0,y.jsx)(c.A,{variant:"caption",color:"text",children:"Description"}),(0,y.jsx)(c.A,{variant:"body2",children:a.description})]})]})}),(0,y.jsxs)(b.A,{children:["completed"===a.status&&(0,y.jsx)(d.A,{variant:"outlined",color:"warning",onClick:()=>l(a),children:"Process Refund"}),"pending"===a.status&&(0,y.jsx)(d.A,{variant:"outlined",color:"error",onClick:()=>s(a),children:"Cancel Payment"}),(0,y.jsx)(d.A,{variant:"contained",onClick:n,children:"Close"})]})]}):null}function N(e){let{open:t,onClose:n,selectedPayments:a,onBulkAction:s}=e;const[i,r]=(0,l.useState)("");return(0,y.jsxs)(A.A,{open:t,onClose:n,maxWidth:"sm",fullWidth:!0,children:[(0,y.jsxs)(j.A,{children:["Bulk Payment Operations (",a.length," payments selected)"]}),(0,y.jsx)(f.A,{children:(0,y.jsxs)(p.Ay,{container:!0,spacing:2,sx:{mt:1},children:[(0,y.jsx)(p.Ay,{item:!0,xs:12,children:(0,y.jsx)(m.$3,{fullWidth:!0,label:"Operation",value:i,onChange:e=>r(e.target.value),options:[{value:"refund",label:"Process Refunds (Completed only)"},{value:"cancel",label:"Cancel Payments (Pending only)"},{value:"delete",label:"Delete Records"}]})}),(0,y.jsx)(p.Ay,{item:!0,xs:12,children:(0,y.jsxs)(c.A,{variant:"caption",color:"text",children:["refund"===i&&"".concat(a.filter(e=>"completed"===e.status).length," completed payments can be refunded."),"cancel"===i&&"".concat(a.filter(e=>"pending"===e.status).length," pending payments can be cancelled."),"delete"===i&&"All ".concat(a.length," payment records will be deleted.")]})})]})}),(0,y.jsxs)(b.A,{children:[(0,y.jsx)(d.A,{variant:"outlined",onClick:n,children:"Cancel"}),(0,y.jsx)(d.A,{variant:"contained",onClick:()=>{const e=a.map(e=>e.id);switch(i){case"refund":const t=a.filter(e=>"completed"===e.status);if(0===t.length)return void alert("No completed payments selected for refund.");window.confirm("Are you sure you want to refund ".concat(t.length," payments?"))&&s("refund",t.map(e=>e.id));break;case"cancel":const n=a.filter(e=>"pending"===e.status);if(0===n.length)return void alert("No pending payments selected for cancellation.");window.confirm("Are you sure you want to cancel ".concat(n.length," payments?"))&&s("cancel",n.map(e=>e.id));break;case"delete":window.confirm("Are you sure you want to delete ".concat(e.length," payment records? This action cannot be undone."))&&s("delete",e)}n()},disabled:!i,children:"Apply"})]})]})}const D=function(){const[e,t]=(0,l.useState)([]),[n,x]=(0,l.useState)(0),[A,j]=(0,l.useState)(!1),[f,b]=(0,l.useState)(""),[D,B]=(0,l.useState)(""),[M,H]=(0,l.useState)(""),[W,T]=(0,l.useState)(""),[_,R]=(0,l.useState)(""),[L,$]=(0,l.useState)(""),[E,F]=(0,l.useState)(""),[J,O]=(0,l.useState)(""),[V,q]=(0,l.useState)(1),[G,K]=(0,l.useState)(10),[Q,U]=(0,l.useState)("paymentDate"),[X,Y]=(0,l.useState)("desc"),[Z,ee]=(0,l.useState)([]),[te,ne]=(0,l.useState)(!1),[ae,le]=(0,l.useState)(null),[se,ie]=(0,l.useState)(!1),[re,oe]=(0,l.useState)(!1),[ce,de]=(0,l.useState)({open:!1,message:"",severity:"success"}),me=function(e){de({open:!0,message:e,severity:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success"})},ue=(0,l.useCallback)(async()=>{j(!0);try{const e={page:V,pageSize:G,search:f,status:D,type:M,method:W,dateFrom:_,dateTo:L,amountMin:E?parseFloat(E):void 0,amountMax:J?parseFloat(J):void 0,sortBy:Q,sortOrder:X},n=g.A.getPayments(e);t(n.items),x(n.total)}catch(e){me("Error loading payments","error")}finally{j(!1)}},[V,G,f,D,M,W,_,L,E,J,Q,X]);(0,l.useEffect)(()=>{ue()},[ue]);const pe=async e=>{try{g.A.refundPayments([e.id]).refundedCount>0&&(me("Payment refunded successfully"),ie(!1),ue())}catch(t){me("Error processing refund","error")}},xe=async e=>{try{g.A.cancelPayments([e.id]).cancelledCount>0&&(me("Payment cancelled successfully"),ie(!1),ue())}catch(t){me("Error cancelling payment","error")}},he=Math.max(1,Math.ceil(n/G)),ye=e=>{switch(e){case"completed":return"success";case"failed":return"error";case"pending":return"warning";case"refunded":return"info";default:return"default"}},ge=e=>{switch(e){case"loan_payment":return"primary";case"fee":return"warning";case"refund":return"info";default:return"default"}};return(0,y.jsxs)(s.A,{children:[(0,y.jsx)(i.A,{}),(0,y.jsx)(o.A,{mb:3,children:(0,y.jsxs)(p.Ay,{container:!0,spacing:3,children:[(0,y.jsx)(p.Ay,{item:!0,xs:12,md:6,lg:3,children:(0,y.jsx)("div",{className:"payment-management-card enhanced-stats-card",children:(0,y.jsx)(P.A,{color:"secondary",icon:(0,y.jsx)(C.A,{className:"glow-icon-payment glow-icon-active",sx:{fontSize:28},children:"payment"}),title:"Total Payments",count:n.toString(),percentage:{color:"success",amount:"+18%",label:"since last month"}})})}),(0,y.jsx)(p.Ay,{item:!0,xs:12,md:6,lg:3,children:(0,y.jsx)("div",{className:"payment-management-card enhanced-stats-card",children:(0,y.jsx)(P.A,{color:"secondary",icon:(0,y.jsx)(C.A,{className:"glow-icon-payment glow-icon-success",sx:{fontSize:28},children:"check_circle"}),title:"Completed",count:e.filter(e=>"completed"===e.status).length.toString(),percentage:{color:"success",amount:"+12%",label:"processed today"}})})}),(0,y.jsx)(p.Ay,{item:!0,xs:12,md:6,lg:3,children:(0,y.jsx)("div",{className:"payment-management-card enhanced-stats-card",children:(0,y.jsx)(P.A,{color:"warning",icon:(0,y.jsx)(C.A,{className:"glow-icon-payment glow-icon-pending",sx:{fontSize:28},children:"schedule"}),title:"Pending",count:e.filter(e=>"pending"===e.status).length.toString(),percentage:{color:"warning",amount:"+5%",label:"awaiting process"}})})}),(0,y.jsx)(p.Ay,{item:!0,xs:12,md:6,lg:3,children:(0,y.jsx)("div",{className:"payment-management-card enhanced-stats-card",children:(0,y.jsx)(P.A,{color:"secondary",icon:(0,y.jsx)(C.A,{className:"glow-icon-payment glow-icon-success",sx:{fontSize:28},children:"account_balance_wallet"}),title:"Total Revenue",count:"$".concat(e.filter(e=>"completed"===e.status).reduce((e,t)=>e+(t.amount||0),0).toLocaleString()),percentage:{color:"success",amount:"+25%",label:"revenue growth"}})})})]})}),(0,y.jsx)(r.A,{children:(0,y.jsx)(o.A,{p:3,children:(0,y.jsxs)(o.A,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[(0,y.jsxs)(o.A,{children:[(0,y.jsx)(c.A,{variant:"h5",fontWeight:"bold",color:"secondary",children:"Payments Management"}),(0,y.jsxs)(c.A,{variant:"caption",color:"text",children:["Total: ",n," payments | Selected: ",Z.length]})]}),(0,y.jsxs)(o.A,{display:"flex",gap:1,children:[(0,y.jsx)(d.A,{variant:"outlined",onClick:()=>{const t=Z.length?Z:e;g.A.exportCSV("payments",t),me("Exported ".concat(t.length," payments to CSV"))},disabled:!e.length,children:"Export CSV"}),(0,y.jsx)(d.A,{variant:"outlined",onClick:()=>{g.A.exportData("payments"),me("Payments data exported to JSON")},children:"Export JSON"}),Z.length>0&&(0,y.jsxs)(d.A,{variant:"contained",color:"warning",onClick:()=>oe(!0),children:["Bulk Actions (",Z.length,")"]})]})]})})}),(0,y.jsxs)(r.A,{sx:{p:3,mb:3},children:[(0,y.jsx)(o.A,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:(0,y.jsxs)(o.A,{display:"flex",alignItems:"center",gap:2,children:[(0,y.jsx)(c.A,{variant:"h6",fontWeight:"medium",color:"secondary",children:"Filters & Search"}),(0,y.jsx)(m.RL,{placeholder:"Search payments...",value:f,onChange:e=>{b(e.target.value),q(1)},sx:{width:250},size:"small"})]})}),(0,y.jsx)(p.Ay,{container:!0,justifyContent:"center",children:(0,y.jsx)(p.Ay,{item:!0,xs:12,md:10,lg:9,children:(0,y.jsxs)(p.Ay,{container:!0,spacing:2,mb:2,children:[(0,y.jsx)(p.Ay,{item:!0,xs:12,md:2,sx:{display:"flex"},children:(0,y.jsx)(m.$3,{fullWidth:!0,size:"small",label:"Status",value:D,onChange:e=>{B(e.target.value),q(1)},sx:{"& .MuiInputBase-root":{minHeight:40}},options:[{value:"",label:"All"},{value:"completed",label:"Completed"},{value:"failed",label:"Failed"},{value:"pending",label:"Pending"},{value:"refunded",label:"Refunded"},{value:"cancelled",label:"Cancelled"}]})}),(0,y.jsx)(p.Ay,{item:!0,xs:12,md:2,sx:{display:"flex"},children:(0,y.jsx)(m.$3,{fullWidth:!0,size:"small",label:"Type",value:M,onChange:e=>{H(e.target.value),q(1)},sx:{"& .MuiInputBase-root":{minHeight:40}},options:[{value:"",label:"All"},{value:"loan_payment",label:"Loan Payment"},{value:"fee",label:"Fee"},{value:"refund",label:"Refund"}]})}),(0,y.jsx)(p.Ay,{item:!0,xs:12,md:2,sx:{display:"flex"},children:(0,y.jsx)(m.$3,{fullWidth:!0,size:"small",label:"Method",value:W,onChange:e=>{T(e.target.value),q(1)},sx:{"& .MuiInputBase-root":{minHeight:40}},options:[{value:"",label:"All"},{value:"bank_transfer",label:"Bank Transfer"},{value:"card",label:"Card"},{value:"check",label:"Check"},{value:"cash",label:"Cash"}]})}),(0,y.jsx)(p.Ay,{item:!0,xs:12,md:2,sx:{display:"flex"},children:(0,y.jsx)(m.RL,{label:"Date From",type:"date",fullWidth:!0,size:"small",value:_,onChange:e=>{R(e.target.value),q(1)},InputLabelProps:{shrink:!0},sx:{"& .MuiInputBase-root":{minHeight:40}}})}),(0,y.jsx)(p.Ay,{item:!0,xs:12,md:2,sx:{display:"flex"},children:(0,y.jsx)(m.RL,{label:"Date To",type:"date",fullWidth:!0,size:"small",value:L,onChange:e=>{$(e.target.value),q(1)},InputLabelProps:{shrink:!0},sx:{"& .MuiInputBase-root":{minHeight:40}}})}),(0,y.jsx)(p.Ay,{item:!0,xs:12,md:1,sx:{display:"flex"},children:(0,y.jsx)(m.RL,{label:"Min $",type:"number",fullWidth:!0,size:"small",value:E,onChange:e=>{F(e.target.value),q(1)},sx:{"& .MuiInputBase-root":{minHeight:40}}})}),(0,y.jsx)(p.Ay,{item:!0,xs:12,md:1,sx:{display:"flex"},children:(0,y.jsx)(m.RL,{label:"Max $",type:"number",fullWidth:!0,size:"small",value:J,onChange:e=>{O(e.target.value),q(1)},sx:{"& .MuiInputBase-root":{minHeight:40}}})})]})})}),(0,y.jsxs)(o.A,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,y.jsx)(d.A,{variant:"outlined",onClick:()=>{b(""),B(""),H(""),T(""),R(""),$(""),F(""),O(""),q(1)},size:"small",children:"Clear Filters"}),(0,y.jsxs)(o.A,{display:"flex",alignItems:"center",gap:1,children:[(0,y.jsx)(c.A,{variant:"caption",children:"Sort by:"}),(0,y.jsx)(m.$3,{size:"small",value:Q,onChange:e=>U(e.target.value),sx:{"& .MuiInputBase-root":{minHeight:40}},options:[{value:"paymentDate",label:"Payment Date"},{value:"amount",label:"Amount"},{value:"status",label:"Status"},{value:"type",label:"Type"},{value:"borrowerName",label:"Borrower"}]}),(0,y.jsx)(m.$3,{size:"small",value:X,onChange:e=>Y(e.target.value),sx:{"& .MuiInputBase-root":{minHeight:40}},options:[{value:"asc",label:"Ascending"},{value:"desc",label:"Descending"}]})]})]})]}),(0,y.jsxs)(r.A,{children:[(0,y.jsx)(u.A,{columns:[{id:"id",label:"Payment ID",width:120,minWidth:120,align:"left",format:e=>(0,y.jsx)(o.A,{className:"payment-id",minHeight:"48px",display:"flex",alignItems:"center",children:(0,y.jsx)(c.A,{variant:"body2",fontWeight:"medium",children:e})})},{id:"borrowerName",label:"Borrower",width:200,minWidth:150,align:"left",format:e=>(0,y.jsx)(o.A,{className:"payment-borrower",minHeight:"48px",display:"flex",alignItems:"center",children:(0,y.jsx)(c.A,{variant:"body2",children:e})})},{id:"amount",label:"Amount",width:140,align:"right",format:e=>(0,y.jsx)(o.A,{className:"payment-amount",minHeight:"48px",display:"flex",alignItems:"center",justifyContent:"flex-end",children:(0,y.jsx)(c.A,{variant:"body2",fontWeight:"medium",color:"success",children:h._J.currency(e||0)})})},{id:"type",label:"Type",width:120,align:"center",format:e=>(0,y.jsx)(o.A,{className:"payment-type",minHeight:"48px",display:"flex",alignItems:"center",justifyContent:"center",children:(0,y.jsx)(v.A,{label:e,color:ge(e),size:"small"})})},{id:"method",label:"Method",width:140,align:"left",format:e=>(0,y.jsx)(o.A,{className:"payment-method",minHeight:"48px",display:"flex",alignItems:"center",children:(0,y.jsx)(c.A,{variant:"body2",children:e})})},{id:"status",label:"Status",width:120,align:"center",format:e=>(0,y.jsx)(o.A,{className:"payment-status status-chip",minHeight:"48px",display:"flex",alignItems:"center",justifyContent:"center",children:(0,y.jsx)(v.A,{label:e,color:ye(e),size:"small"})})},{id:"paymentDate",label:"Date",width:140,align:"center",format:e=>{const t=e?new Date(e):null;return(0,y.jsx)(o.A,{className:"payment-date",minHeight:"48px",display:"flex",alignItems:"center",justifyContent:"center",children:(0,y.jsx)(c.A,{variant:"body2",children:t&&!isNaN(t.getTime())?h._J.date(t):"\u2014"})})}},{id:"actions",label:"Actions",width:150,align:"center",format:(e,t)=>(0,y.jsxs)(o.A,{className:"payment-actions",minHeight:"48px",display:"flex",alignItems:"center",justifyContent:"center",gap:1,children:[(0,y.jsx)(w.A,{size:"small",onClick:()=>{le(t),ie(!0)},children:(0,y.jsx)(C.A,{fontSize:"small",children:"visibility"})}),"completed"===t.status&&(0,y.jsx)(w.A,{size:"small",color:"warning",onClick:()=>pe(t),children:(0,y.jsx)(C.A,{fontSize:"small",children:"undo"})}),"pending"===t.status&&(0,y.jsx)(w.A,{size:"small",color:"error",onClick:()=>xe(t),children:(0,y.jsx)(C.A,{fontSize:"small",children:"cancel"})})]})}],data:e,selectedItems:Z,onSelectAll:t=>{ne(t),ee(t?[...e]:[])},onSelectItem:(e,t)=>{t?ee([...Z,e]):(ee(Z.filter(t=>t.id!==e.id)),ne(!1))},showCheckbox:!0,stickyHeader:!1,maxHeight:"65vh"}),(0,y.jsxs)(o.A,{p:3,display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,y.jsxs)(o.A,{display:"flex",alignItems:"center",gap:2,children:[(0,y.jsx)(c.A,{variant:"caption",children:"Page size:"}),(0,y.jsx)(m.$3,{size:"small",value:G,onChange:e=>{K(Number(e.target.value)),q(1)},options:[{value:5,label:"5"},{value:10,label:"10"},{value:25,label:"25"},{value:50,label:"50"}]})]}),(0,y.jsx)(I.A,{count:he,page:V,onChange:(e,t)=>q(t),color:"primary"})]}),(0,y.jsx)(z,{open:se,onClose:()=>ie(!1),payment:ae,onRefund:pe,onCancel:xe}),(0,y.jsx)(N,{open:re,onClose:()=>oe(!1),selectedPayments:Z,onBulkAction:async(e,t)=>{try{let n;switch(e){case"refund":n=g.A.refundPayments(t),me("".concat(n.refundedCount," payments refunded"));break;case"cancel":n=g.A.cancelPayments(t),me("".concat(n.cancelledCount," payments cancelled"));break;case"delete":n=g.A.bulkDeletePayments(t),me("".concat(n.deletedCount," payment records deleted"))}ee([]),ne(!1),ue()}catch(n){me("Error performing bulk operation","error")}}}),(0,y.jsx)(S.A,{open:ce.open,autoHideDuration:4e3,onClose:()=>de((0,a.A)((0,a.A)({},ce),{},{open:!1})),children:(0,y.jsx)(k.A,{severity:ce.severity,onClose:()=>de((0,a.A)((0,a.A)({},ce),{},{open:!1})),children:ce.message})})]})]})}}}]);
//# sourceMappingURL=207.7d7c1ec1.chunk.js.map